# short_url_service
short_url_service: Сокращение URL-ссылок — это программа, написанная на языке Go, которая позволяет пользователям создавать короткие URL-ссылки для длинных URL-ссылок. Программа использует базу данных PostgreSQL и LRU кэш для хранения оригинальных URL-ссылок и их коротких версий.

## Основные функции: 
Сокращение URL-ссылок: Пользователи могут ввести длинную URL-ссылку и получить короткую версию для использования.

Аудит: Программа ведет журнал всех операций, связанных с сокращением URL-ссылок. 

Тестирование: Программа содержит комплексные тесты, обеспечивающие стабильность и надежность.

Программу можно запустить на базе данных Postgres или же на базе LRU кэша.
Это зависит от флага запуска `-d`.

LRU cache хранит в себе короткие URL-ссылки и их оригинальные URL-ссылки до определенного количества(по умолчанию поставил 10) которое укажете сами, далее удаляет самые старые ссылки.

## Установка:

```
git clone https://github.com/evilgooby/ShortUrl.git
```

## Использование: 
Запустите программу:
```
sudo docker compose build
sudo docker compose up
```
Программа запустится на базе Postgres.
Если вы хотите запустить программу на базе LRU кэша, нужно поменять в dockerfile команду ENTRYPOINT на   `ENTRYPOINT ["go", "run", "./cmd", "-d", "main.go"]` .

Если вы хотите запустить программу на локальной машине в `./config/application.yaml` вставьте в url: `"postgres://user:password@localhost:5432/mydb?sslmode=disable"`
в поле user и password вы должны вставить логин и пароль для доступа к вашей БД postgres.

Введите длинную URL-ссылку, которую вы хотите сократить.

Программа сгенерирует короткую версию URL-ссылки.**

Пример запроса: 
```
curl -X POST -H "Content-Type: application/json" -d '{"long_url": "https://rutube.ru/video/c4e6290ace7933b84b73810771a6f31e/"}' http://localhost:8080/CreateShortUrl
```
Пример ответа:
```JSON
{
  "short_url":"http://localhost:8080/XkXzo63P"
}
```
Пример запроса:
```
curl -X GET -H "Content-Type: application/json" -d '{"short_url":"http://localhost:8080/XkXzo63P"}' http://localhost:8080/GetLongUrl
```
Пример ответа:
```JSON
{
  "long_url":"https://rutube.ru/video/c4e6290ace7933b84b73810771a6f31e/"
}
```

Так же в данной программе можно было бы хранить данные в Redis но я решил использовать LRU кэш.
